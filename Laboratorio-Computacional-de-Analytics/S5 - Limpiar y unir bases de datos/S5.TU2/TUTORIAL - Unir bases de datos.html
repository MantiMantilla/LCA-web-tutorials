
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Unir bases de datos utilizando pandas &#8212; Repositorio de LCA</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Repositorio de LCA</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Tutoriales Módulo 1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../S1%20-%20Bienvenida%2C%20estructuras%20de%20datos%20y%20de%20control/S1.TU1/TUTORIAL%20-%20Bienvenida%20a%20Jupyter%20Notebook.html">
   Celdas, variables y tipos de datos, importación de paquetes, y errores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../S1%20-%20Bienvenida%2C%20estructuras%20de%20datos%20y%20de%20control/S1.TU2/TUTORIAL%20-%20Estructuras%20de%20datos.html">
   Estructuras de datos: listas, tuplas, conjuntos y diccionarios
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutoriales Módulo 2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../S3%20-%20Librerias%20para%20manejo%20de%20datos/S3.TU1/TUTORIAL%20-%20Librerias%20para%20manejo%20de%20datos.html">
   Librerías para manejo de datos:
   <code class="docutils literal notranslate">
    <span class="pre">
     numpy
    </span>
   </code>
   y
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/Laboratorio-Computacional-de-Analytics/S5 - Limpiar y unir bases de datos/S5.TU2/TUTORIAL - Unir bases de datos.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mantimantilla/LCA-web-tutorials"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mantimantilla/LCA-web-tutorials/issues/new?title=Issue%20on%20page%20%2FLaboratorio-Computacional-de-Analytics/S5 - Limpiar y unir bases de datos/S5.TU2/TUTORIAL - Unir bases de datos.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mantimantilla/LCA-web-tutorials/main?urlpath=tree/LCA-book/Laboratorio-Computacional-de-Analytics/S5 - Limpiar y unir bases de datos/S5.TU2/TUTORIAL - Unir bases de datos.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#requisitos">
   Requisitos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objetivos">
   Objetivos
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unir-bases-de-datos">
   1. Unir bases de datos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unir-bases-de-datos-por-coincidencia-de-columnas">
     1.1. Unir bases de datos por coincidencia de columnas
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#metodo-append">
       Método
       <code class="docutils literal notranslate">
        <span class="pre">
         append
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ejemplo-1">
         Ejemplo 1
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unir-bases-de-datos-por-coincidencia-de-filas">
     1.2. Unir bases de datos por coincidencia de filas
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#metodo-join">
       Método
       <code class="docutils literal notranslate">
        <span class="pre">
         join
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#metodo-merge">
       Método
       <code class="docutils literal notranslate">
        <span class="pre">
         merge
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniones-uno-a-uno">
       Uniones uno a uno
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ejemplo-2">
         Ejemplo 2
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniones-uno-a-n">
       Uniones uno a
       <span class="math notranslate nohighlight">
        \(n\)
       </span>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ejemplo-3">
         Ejemplo 3
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniones-n-a-1">
       Uniones
       <span class="math notranslate nohighlight">
        \(n\)
       </span>
       a 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniones-n-a-n">
       Uniones
       <span class="math notranslate nohighlight">
        \(n\)
       </span>
       a
       <span class="math notranslate nohighlight">
        \(n\)
       </span>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ejemplo-4">
         Ejemplo 4
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unir-bases-de-datos-por-coincidencia-de-filas-o-columnas">
     1.3 Unir bases de datos por coincidencia de filas o columnas
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#metodo-concat">
       Método
       <code class="docutils literal notranslate">
        <span class="pre">
         concat
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#ejemplo-5">
         Ejemplo 5
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#referencias">
   Referencias
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creditos">
   Créditos
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <img src="Archivos/miad4.png" width=800x>
<div class="section" id="unir-bases-de-datos-utilizando-pandas">
<h1>Unir bases de datos utilizando <code class="docutils literal notranslate"><span class="pre">pandas</span></code><a class="headerlink" href="#unir-bases-de-datos-utilizando-pandas" title="Permalink to this headline">¶</a></h1>
<p>La información para analizar un problema no siempre se encuentra toda en un mismo archivo. Por lo anterior, es necesario unir la información disponible de múltiples fuentes en una misma base de datos. A continuación, expondremos los métodos disponibles en <code class="docutils literal notranslate"><span class="pre">pandas</span></code> para llevar a cabo esa tarea.</p>
<div class="section" id="requisitos">
<h2>Requisitos<a class="headerlink" href="#requisitos" title="Permalink to this headline">¶</a></h2>
<p>Para desarrollar este tutorial necesitarás:</p>
<ul class="simple">
<li><p>Conocer las principales características de los arreglos en <code class="docutils literal notranslate"><span class="pre">numpy</span></code> y de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p></li>
<li><p>Importar datos a un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> desde distintos formatos.</p></li>
<li><p>Indexar un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a partir de una o más columnas.</p></li>
</ul>
</div>
<div class="section" id="objetivos">
<h2>Objetivos<a class="headerlink" href="#objetivos" title="Permalink to this headline">¶</a></h2>
<p>Al final de este tutorial podrás:</p>
<p><strong>1.</strong> Agregar filas de un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a otro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. <br>
<strong>2.</strong> Agregar columnas de un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a otro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. <br>
<strong>3.</strong> Unir dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> de forma más flexible por coincidencia de filas o columnas.</p>
</div>
<div class="section" id="unir-bases-de-datos">
<h2>1. Unir bases de datos<a class="headerlink" href="#unir-bases-de-datos" title="Permalink to this headline">¶</a></h2>
<p>Unir bases de datos significa consolidar la información existente en dos o más bases de datos de acuerdo con la coincidencia, bien sea de sus columnas, o de sus filas.</p>
<div class="section" id="unir-bases-de-datos-por-coincidencia-de-columnas">
<h3>1.1. Unir bases de datos por coincidencia de columnas<a class="headerlink" href="#unir-bases-de-datos-por-coincidencia-de-columnas" title="Permalink to this headline">¶</a></h3>
<div class="section" id="metodo-append">
<h4>Método <code class="docutils literal notranslate"><span class="pre">append</span></code><a class="headerlink" href="#metodo-append" title="Permalink to this headline">¶</a></h4>
<p>Agrega a un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> las filas de otro según coincidan las columnas en los dos.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DataFrame.append(other, ignore_index = False, verify_integrity = False, sort = False) 
</pre></div>
</div>
<p>Debido a que se usa la coincidencia de columnas. Si el <code class="docutils literal notranslate"><span class="pre">DataDrame</span></code> que llama el método tiene <span class="math notranslate nohighlight">\(n\)</span> filas y el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> por parámetro tiene <span class="math notranslate nohighlight">\(m\)</span> filas, el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante tendrá <span class="math notranslate nohighlight">\(n+m\)</span> filas. A continuación una explicación de los parámetros.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a unir. <br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">True</span></code>: la base de datos resultante no tendrá en cuenta los índices de ninguno de los dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> y asignará un índice numérico desde <span class="math notranslate nohighlight">\(0\)</span> hasta <span class="math notranslate nohighlight">\(n+m-1\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">False</span></code>: el índice de la base de datos resultante conserva los índices de los dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">verify_integrity</span></code>: solo aplica si <code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">False</span></code>. Por defecto, <code class="docutils literal notranslate"><span class="pre">verify_index</span> <span class="pre">=</span> <span class="pre">False</span></code>.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">verify_integrity</span> <span class="pre">=</span> <span class="pre">True</span></code>: arroja <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> si en el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante hay indices duplicados.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verify_integrity</span> <span class="pre">=</span> <span class="pre">False</span></code>: permite tener índices repetidos en el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code>: Por defecto, <code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">False</span></code>.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">True</span></code>: asigna un orden lexicográfico a las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">False</span></code>: preserva el orden en el que aparecen las columnas de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales.</p></li>
</ul>
</li>
</ul>
<p>Importamos el paquete <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ejemplo-1">
<h5>Ejemplo 1<a class="headerlink" href="#ejemplo-1" title="Permalink to this headline">¶</a></h5>
<p>En la celda de código encontramos dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. Se nos pide unirlos con base en la coincidencia de sus columnas. Las columnas del <code class="docutils literal notranslate"><span class="pre">DafaFrame</span></code> resultante deben estar ordenadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Usamos el método <code class="docutils literal notranslate"><span class="pre">append</span></code>, ingresando como parámetro <code class="docutils literal notranslate"><span class="pre">df2</span></code> y estableciendo <code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">True</span></code> para ordenar las columnas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>4</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>6</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="unir-bases-de-datos-por-coincidencia-de-filas">
<h3>1.2. Unir bases de datos por coincidencia de filas<a class="headerlink" href="#unir-bases-de-datos-por-coincidencia-de-filas" title="Permalink to this headline">¶</a></h3>
<p>Estos métodos agregan a un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> las columnas de otro según coincidan las filas en los dos.</p>
<div class="section" id="metodo-join">
<h4>Método <code class="docutils literal notranslate"><span class="pre">join</span></code><a class="headerlink" href="#metodo-join" title="Permalink to this headline">¶</a></h4>
<p>Agrega a un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> las columnas de otro según coincidan los indices en los dos. Puede usarse una columna en lugar de su índice para el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DataFrame.join(other, on = None, how = &#39;left&#39;, lsuffix = &#39;&#39;, rsuffix = &#39;&#39;, sort = False)
</pre></div>
</div>
<p>A continuación una explicación de los parámetros.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a unir.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: permite usar una o varias columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método para encontrar las coincidencias. De no especificarla, se encuentran las coincidencias en los índices.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code>: es <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;left&quot;</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante tendrá el mismo número de filas que el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método, ya que se usan solo las coincidencias con el índice o columna de este <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;right&quot;</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante tendrá el mismo número de filas que el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> entra por parámetro, ya que se usan solo las coincidencias con el índice o columna de este <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;outer&quot;</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante tendrá todas las filas de ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, ya que se aceptan todas las coincidencias y no coincidencias de ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span> <span class="pre">=</span> <span class="pre">&quot;inner&quot;</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante solo tendrá los índices que exisan en ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">lsufix</span></code>: si hay una o más columnas que tienen el mismo nombre en ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, se le puede asignar un sufijo a las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método para así diferenciarlas de las columnas del otro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rsuffix</span></code>: si hay una o más columnas que tienen el mismo nombre en ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, se les puede asignar un sufijo a las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que entra por parámetro para así diferenciarlas de las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">True</span></code>: asigna un orden lexicográfico a las filas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">False</span></code>: preserva el orden en el que aparecen las filas de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="metodo-merge">
<h4>Método <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#metodo-merge" title="Permalink to this headline">¶</a></h4>
<p>Agrega a un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> las columnas de otro según coincidan los indices en los dos. Puede usarse una columna en lugar de su índice para ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. En este sentido, <code class="docutils literal notranslate"><span class="pre">merge</span></code> es más flexible que <code class="docutils literal notranslate"><span class="pre">join</span></code>, puesto que permite usar las coincidencias con las columnas del otro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DataFrame.merge(right, how = &#39;inner&#39;, on = None, left_on = None, right_on = None, left_index = False, right_index = False, sort = False, suffixes = (&#39;_x&#39;, &#39;_y&#39;), indicator = False)
</pre></div>
</div>
<p>A continuación una explicación de los parámetros.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code>: el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> a unir.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code>: se tienen las mismas opciones que con el método <code class="docutils literal notranslate"><span class="pre">join</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code> e <code class="docutils literal notranslate"><span class="pre">&quot;inner&quot;</span></code>.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on</span></code>: nombre de una columna que se encuentre en ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> para identificar las coincidencias de la unión. Alternativamente pueden usarse los parámetros <code class="docutils literal notranslate"><span class="pre">left_on</span></code> (o <code class="docutils literal notranslate"><span class="pre">left_index</span></code>) y <code class="docutils literal notranslate"><span class="pre">right_on</span></code> (o <code class="docutils literal notranslate"><span class="pre">right_index</span></code>).<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_on</span></code>: nombres de las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método, utilizadas para identificar las coincidencias.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_on</span></code>: nombres de las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que entra por parámetro, utilizadas para identificar las coincidencias.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_index</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">left_index</span> <span class="pre">=</span> <span class="pre">True</span></code>: especifica que se usa el índice del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llama al método, para identificar las coincidencias.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">left_index</span> <span class="pre">=</span> <span class="pre">False</span></code>: toma las columnas especificadas en <code class="docutils literal notranslate"><span class="pre">on</span></code> o en <code class="docutils literal notranslate"><span class="pre">left_on</span></code>.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_index</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">right_index</span> <span class="pre">=</span> <span class="pre">True</span></code>: especifica que se usa el índice del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que entra por parámetro, para identificar las coincidencias.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">right_index</span> <span class="pre">=</span> <span class="pre">False</span></code>: toma las columnas especificadas en <code class="docutils literal notranslate"><span class="pre">on</span></code> o en <code class="docutils literal notranslate"><span class="pre">right_on</span></code>.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">True</span></code>: asigna un orden lexicográfico a las filas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">False</span></code>: preserva el orden en el que aparecen las filas de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">suffixes</span></code>: recibe una tupla de dos posiciones con los sufijos que se usarán para distinguir en caso de que existan columnas de nombre repetido.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indicator</span></code>: agrega una columna que indica el <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> del cual proviene la fila.</p></li>
</ul>
</div>
<div class="section" id="uniones-uno-a-uno">
<h4>Uniones uno a uno<a class="headerlink" href="#uniones-uno-a-uno" title="Permalink to this headline">¶</a></h4>
<p>Recordemos que la llave de una base de datos es una columna cuyos registros no se repiten. Podemos usar esta llave para indexar nuestro <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> y este puede estar compuesto por una o más columnas.</p>
<p>La unión uno a uno se hace entre dos bases de datos de acuerdo con las coincidencias entre las llaves de ambas. Se entiende como una unión uno a uno, ya que en ambas bases de datos las llaves deben ser únicas y por lo tanto no existen coincidencias repetidas.</p>
<div class="section" id="ejemplo-2">
<h5>Ejemplo 2<a class="headerlink" href="#ejemplo-2" title="Permalink to this headline">¶</a></h5>
<p>Consideremos los siguientes <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Debemos agregar a <code class="docutils literal notranslate"><span class="pre">df</span></code>las columnas de <code class="docutils literal notranslate"><span class="pre">df2</span></code> según coincidencia de índices uno a uno, preservar todas las filas de <code class="docutils literal notranslate"><span class="pre">df</span></code> y solo las filas que coinciden de <code class="docutils literal notranslate"><span class="pre">df2</span></code>.</p>
<p>Utilicemos el método <code class="docutils literal notranslate"><span class="pre">merge</span></code>, especificando que la unión será por coincidencias interiores (que suceden en ambos) y activando las opciones de <code class="docutils literal notranslate"><span class="pre">left_index</span></code> y <code class="docutils literal notranslate"><span class="pre">right_index</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">left_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Alternativamente, podemos utilizar el método <code class="docutils literal notranslate"><span class="pre">join</span></code>. Con este solo necesitamos dos argumentos, puesto que por defecto se usa el índice para la coincidencia de filas de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="uniones-uno-a-n">
<h4>Uniones uno a <span class="math notranslate nohighlight">\(n\)</span><a class="headerlink" href="#uniones-uno-a-n" title="Permalink to this headline">¶</a></h4>
<p>La unión uno a <span class="math notranslate nohighlight">\(n\)</span> se hace entre dos bases de datos de acuerdo con las coincidencias entre la llave de la primera y una columna cualquiera de la segunda (esta columna puede contener valores repetidos). Se entiende como una unión uno a <span class="math notranslate nohighlight">\(n\)</span>, ya que para cada registro de la llave de la primera base de datos pueden existir hasta <span class="math notranslate nohighlight">\(n\)</span> coincidencias en la segunda.</p>
<div class="section" id="ejemplo-3">
<h5>Ejemplo 3<a class="headerlink" href="#ejemplo-3" title="Permalink to this headline">¶</a></h5>
<p>Consideremos los siquientes <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;Juan&quot;</span><span class="p">,</span>    <span class="s2">&quot;Contabilidad&quot;</span><span class="p">,</span> <span class="mi">2100</span><span class="p">],</span>
                   <span class="p">[</span><span class="s2">&quot;Ignacio&quot;</span><span class="p">,</span> <span class="s2">&quot;Ingeniería&quot;</span><span class="p">,</span>   <span class="mi">2000</span><span class="p">],</span>
                   <span class="p">[</span><span class="s2">&quot;Andrea&quot;</span><span class="p">,</span>  <span class="s2">&quot;Ingeniería&quot;</span><span class="p">,</span>   <span class="mi">2000</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Empleado&quot;</span><span class="p">,</span> <span class="s2">&quot;Equipo&quot;</span><span class="p">,</span> <span class="s2">&quot;Salario&quot;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;Ingeniería&quot;</span><span class="p">,</span>   <span class="s2">&quot;Alex&quot;</span>   <span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Contabilidad&quot;</span><span class="p">,</span> <span class="s2">&quot;Antonia&quot;</span><span class="p">]],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Equipo&quot;</span><span class="p">,</span> <span class="s2">&quot;Supervisor&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Debemos agregar a <code class="docutils literal notranslate"><span class="pre">df</span></code>las columnas de <code class="docutils literal notranslate"><span class="pre">df2</span></code> según coincidencia de índices uno a <span class="math notranslate nohighlight">\(n\)</span>, preservar todas las filas de <code class="docutils literal notranslate"><span class="pre">df</span></code> y solo las filas que coinciden de <code class="docutils literal notranslate"><span class="pre">df2</span></code>.</p>
<p>Utilicemos el método <code class="docutils literal notranslate"><span class="pre">merge</span></code>, especificando que la unión será por coincidencias interiores (que suceden en ambos), y que la columna <code class="docutils literal notranslate"><span class="pre">&quot;Equipo&quot;</span></code> existe en ambos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span>  <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;Equipo&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Empleado</th>
      <th>Equipo</th>
      <th>Salario</th>
      <th>Supervisor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Juan</td>
      <td>Contabilidad</td>
      <td>2100</td>
      <td>Antonia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ignacio</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Andrea</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Habriamos podido especificar cuál columna usar en cada <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, pero esto no fue necesario puesto que las columnas tienen el mismo nombre.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s2">&quot;Equipo&quot;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s2">&quot;Equipo&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Empleado</th>
      <th>Equipo</th>
      <th>Salario</th>
      <th>Supervisor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Juan</td>
      <td>Contabilidad</td>
      <td>2100</td>
      <td>Antonia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ignacio</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Andrea</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si quisieramos usar el método <code class="docutils literal notranslate"><span class="pre">join</span></code> debemos indexar el segundo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> según su columna con la que evaluamos las coincidencias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Equipo&quot;</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;Equipo&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Empleado</th>
      <th>Equipo</th>
      <th>Salario</th>
      <th>Supervisor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Juan</td>
      <td>Contabilidad</td>
      <td>2100</td>
      <td>Antonia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ignacio</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Andrea</td>
      <td>Ingeniería</td>
      <td>2000</td>
      <td>Alex</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="uniones-n-a-1">
<h4>Uniones <span class="math notranslate nohighlight">\(n\)</span> a 1<a class="headerlink" href="#uniones-n-a-1" title="Permalink to this headline">¶</a></h4>
<p>Es equivalente a una unión uno a <span class="math notranslate nohighlight">\(n\)</span>, donde la columna seleccionada para las coincidencias de la primera base de datos puede tener valores repetidos y las coincidencias con la segunda base de datos se evalúan utilizando su llave.</p>
</div>
<div class="section" id="uniones-n-a-n">
<h4>Uniones <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n\)</span><a class="headerlink" href="#uniones-n-a-n" title="Permalink to this headline">¶</a></h4>
<p>La unión <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n\)</span> se hace entre dos bases de datos de acuerdo con las coincidencias entre una columna (o grupo de columnas) de la primera y una columna (o grupo de columnas) de la segunda. Se entiende como una unión <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n\)</span>, ya que para cada registro (repetido o no) de la primera base de datos pueden existir hasta <span class="math notranslate nohighlight">\(n\)</span> coincidencias en la segunda. No es relevante que en una o en otra se evalúe la coincidencia de una llave.</p>
<p>Es importante mencionar que este tipo de unión es poco común y en ocasiones hasta desaconsejado por algunos programas especializados en manejo de datos (Stata, 2013).</p>
<div class="section" id="ejemplo-4">
<h5>Ejemplo 4<a class="headerlink" href="#ejemplo-4" title="Permalink to this headline">¶</a></h5>
<p>Consideramos los siguientes <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;Juan&quot;</span><span class="p">,</span>    <span class="s2">&quot;Tennis&quot;</span>    <span class="p">],</span>
                   <span class="p">[</span><span class="s2">&quot;Ignacio&quot;</span><span class="p">,</span> <span class="s2">&quot;Tennis&quot;</span>    <span class="p">],</span> 
                   <span class="p">[</span><span class="s2">&quot;Andrea&quot;</span><span class="p">,</span>  <span class="s2">&quot;Baloncesto&quot;</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alex&quot;</span><span class="p">,</span> <span class="s2">&quot;Deporte&quot;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">&quot;Tennis&quot;</span><span class="p">,</span>     <span class="s2">&quot;Raquetas&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Tennis&quot;</span><span class="p">,</span>     <span class="s2">&quot;Pelotas&quot;</span> <span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Baloncesto&quot;</span><span class="p">,</span> <span class="s2">&quot;Balón&quot;</span>   <span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Baloncesto&quot;</span><span class="p">,</span> <span class="s2">&quot;Red&quot;</span>     <span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Natación&quot;</span><span class="p">,</span>   <span class="s2">&quot;Piscina&quot;</span> <span class="p">]],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Deporte&quot;</span><span class="p">,</span> <span class="s2">&quot;Implemento&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Debemos unir los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> de la celda de código en una relación <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n\)</span> entre las columnas <code class="docutils literal notranslate"><span class="pre">&quot;Tutoriales&quot;</span></code>. Además debemos emplear todas las coincidencias.</p>
<p>Debemos agregar a <code class="docutils literal notranslate"><span class="pre">df</span></code>las columnas de <code class="docutils literal notranslate"><span class="pre">df2</span></code> según coincidencia de índices <span class="math notranslate nohighlight">\(n\)</span> a <span class="math notranslate nohighlight">\(n\)</span>, preservar todas las filas de <code class="docutils literal notranslate"><span class="pre">df</span></code> y todas las filas de <code class="docutils literal notranslate"><span class="pre">df2</span></code>.</p>
<p>Utilizamos el método <code class="docutils literal notranslate"><span class="pre">merge</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;outer&quot;</span><span class="p">,</span>  <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;Deporte&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Alex</th>
      <th>Deporte</th>
      <th>Implemento</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Juan</td>
      <td>Tennis</td>
      <td>Raquetas</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Juan</td>
      <td>Tennis</td>
      <td>Pelotas</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ignacio</td>
      <td>Tennis</td>
      <td>Raquetas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ignacio</td>
      <td>Tennis</td>
      <td>Pelotas</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Andrea</td>
      <td>Baloncesto</td>
      <td>Balón</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Andrea</td>
      <td>Baloncesto</td>
      <td>Red</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>Natación</td>
      <td>Piscina</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Declaramos <code class="docutils literal notranslate"><span class="pre">&quot;Deporte&quot;</span></code> como el índice para poder utilizar el método <code class="docutils literal notranslate"><span class="pre">join</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Deporte&quot;</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;Deporte&quot;</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Alex</th>
      <th>Deporte</th>
      <th>Implemento</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>Juan</td>
      <td>Tennis</td>
      <td>Raquetas</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>Juan</td>
      <td>Tennis</td>
      <td>Pelotas</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>Ignacio</td>
      <td>Tennis</td>
      <td>Raquetas</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>Ignacio</td>
      <td>Tennis</td>
      <td>Pelotas</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>Andrea</td>
      <td>Baloncesto</td>
      <td>Balón</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>Andrea</td>
      <td>Baloncesto</td>
      <td>Red</td>
    </tr>
    <tr>
      <th>NaN</th>
      <td>NaN</td>
      <td>Natación</td>
      <td>Piscina</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="unir-bases-de-datos-por-coincidencia-de-filas-o-columnas">
<h3>1.3 Unir bases de datos por coincidencia de filas o columnas<a class="headerlink" href="#unir-bases-de-datos-por-coincidencia-de-filas-o-columnas" title="Permalink to this headline">¶</a></h3>
<div class="section" id="metodo-concat">
<h4>Método <code class="docutils literal notranslate"><span class="pre">concat</span> </code><a class="headerlink" href="#metodo-concat" title="Permalink to this headline">¶</a></h4>
<p>Agrega por coincidencia de filas o columnas (no ambas al tiempo) y permite flexibilidad para nombrar los índices y las columnas.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>concat(objs, axis = 0, join = &#39;outer&#39;, ignore_index = False, keys = None, sort = False)
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">objs</span></code>: en este caso no hay un <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> que llame al método. Para este argumento debe incluirse una lista con dos o más <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> para unir.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code>: es <code class="docutils literal notranslate"><span class="pre">0</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">0</span></code>: define la unión de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> por coincidencia de filas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1</span></code>: define la unión de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> por coincidencia de columnas.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span></code>: es <code class="docutils literal notranslate"><span class="pre">&quot;outer&quot;</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span> <span class="pre">=</span> <span class="pre">&quot;inner&quot;</span></code>: permite únicamente permite coincidencias mutuas.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">join</span> <span class="pre">=</span> <span class="pre">&quot;outer&quot;</span></code>: permite la totalidad de las filas de ambos.<br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">True</span></code>: la base de datos resultante no tendrá en cuenta los índices de ninguno de los dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> y asignará un índice numérico.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index</span> <span class="pre">=</span> <span class="pre">False</span></code>: el índice de la base de datos resultante conserva los índices de los dos <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales. <br><br></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">keys</span></code>: con el objetivo de conservar las columnas o los índices de ambas bases de datos se le puede asignar una llave por cada <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, de tal manera que se pueda construir un índice múltiple o columnas múltiple. Los índices y columnas pasan de ser sencillos a representarse con tuplas.<br><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code>: es <code class="docutils literal notranslate"><span class="pre">False</span></code> por defecto.<br><br></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">True</span></code>: asigna un orden lexicográfico a las filas o columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> resultante.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span> <span class="pre">=</span> <span class="pre">False</span></code>: preserva el orden en el que aparecen las filas o columnas de los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> originales.</p></li>
</ul>
</li>
</ul>
<div class="section" id="ejemplo-5">
<h5>Ejemplo 5<a class="headerlink" href="#ejemplo-5" title="Permalink to this headline">¶</a></h5>
<p>Consideramos los siguientes <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Debemos unir los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> por coincidencia de columnas y crear un índice múltiple (de tipo tupla) para diferenciar la información proveniente de cada uno de ellos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span>  <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">d1</th>
      <th>0</th>
      <td>1.0</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">d2</th>
      <th>0</th>
      <td>NaN</td>
      <td>3</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>1</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>El índice del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> está compuesto por tuplas, y no por valores sencillos como en los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> vistos anteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;d1&#39;, 0),
            (&#39;d1&#39;, 1),
            (&#39;d1&#39;, 2),
            (&#39;d2&#39;, 0),
            (&#39;d2&#39;, 1),
            (&#39;d2&#39;, 2)],
           )
</pre></div>
</div>
</div>
</div>
<p>Ahora, uniremos los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> por coincidencia de filas y crearemos un índice múltiple (de tipo tupla) para diferenciar la información proveniente de cada uno de ellos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span><span class="n">df2</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">d1</th>
      <th colspan="3" halign="left">d2</th>
    </tr>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>B</th>
      <th>C</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Las columnas del <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> están compuestas por tuplas, y no por valores sencillos como en los <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> vistos anteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(&#39;d1&#39;, &#39;A&#39;),
            (&#39;d1&#39;, &#39;B&#39;),
            (&#39;d2&#39;, &#39;B&#39;),
            (&#39;d2&#39;, &#39;C&#39;),
            (&#39;d2&#39;, &#39;E&#39;)],
           )
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="referencias">
<h2>Referencias<a class="headerlink" href="#referencias" title="Permalink to this headline">¶</a></h2>
<p>Python (2020). Documentación sobre <code class="docutils literal notranslate"><span class="pre">datetime</span></code>. Recuperado el 14 de diciembre de 2020 de:
<a class="reference external" href="https://docs.python.org/es/3/library/datetime.html">https://docs.python.org/es/3/library/datetime.html</a></p>
<p>Stata (2013). Documentación sobre Merge. Recuperado el 14 de diciembre de 2020 de:
<a class="reference external" href="https://www.stata.com/manuals13/dmerge.pdf">https://www.stata.com/manuals13/dmerge.pdf</a></p>
<p>J. VanderPlas (2016) Python Data Science Handbook: Essential Tools for Working with Data O’Reilly Media, Inc.</p>
</div>
<div class="section" id="creditos">
<h2>Créditos<a class="headerlink" href="#creditos" title="Permalink to this headline">¶</a></h2>
<p><strong>Autor(es):</strong> Jorge Esteban Camargo Forero, Alejandro Mantilla Redondo, Diego Alejandro Cely Gomez</p>
<p><strong>Fecha última actualización:</strong> 06/08/2021</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mantimantilla/LCA-web-tutorials",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Laboratorio-Computacional-de-Analytics/S5 - Limpiar y unir bases de datos/S5.TU2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Equipo de LCA<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>